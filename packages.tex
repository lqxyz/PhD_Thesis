
\usepackage{fontspec}
\setmainfont{Arial}
%% \setsansfont{Arial}
%% \setmainfont{Times New Roman}

\usepackage{tocloft}   % This package must be the first one
\usepackage{todo-book}

\usepackage{geometry}
% This has already set in the cls file
% \usepackage[a4paper, left=3cm, right=3cm, top=2cm, bottom=2cm]{geometry}
% \geometry{verbose,a4paper,textwidth=6.in,textheight=9.8in}
% \documentclass[twocolumn,journal]{IEEEtran}

\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{graphicx}
% \usepackage{epstopdf}

\usepackage{fancyhdr}
%  \pagestyle{fancy}
%  \fancypagestyle{plain}{%
%     \fancyhf{} % clear all header and footer fields
%  
%     \lfoot[\thepage]{}
%     \rfoot[]{\thepage}
%     \renewcommand{\headrulewidth}{0pt}
%  }
%  %\fancypagestyle{fancy}{%
%     \fancyhf{}
%     %\renewcommand{\chaptermark}[1]{\markboth{\thechapter.\ #1}{}} 
%     \renewcommand{\chaptermark}[1]{\markboth{Chapter \thechapter.\ #1}{}} % Add Chapter by Qun Liu
%     \lhead{\leftmark}
%     %\rhead{\thepage}
%     \lfoot[\thepage]{}
%     \rfoot[]{\thepage}
%  %}

%%%% Qun Liu modify the header in April 20, 2018 %%%%
\fancyfoot{}
%\fancyhead{}
\renewcommand{\chaptermark}[1]{\markboth{Chapter \thechapter.\ #1}{}}
\renewcommand{\sectionmark}[1]{\markright{\thesection.\ #1}}
%\fancyhead[RO,LE]{\thepage}
%\fancyhead[LO]{\slshape\nouppercase \leftmark}
%\fancyhead[LO]{\nouppercase \leftmark}
%\fancyhead[RE]{\nouppercase \rightmark}
%%% E: Even page, O: Odd page, L: Left field, C: Center field, R: Right field, H: Header, F: Footer
\fancyhead[LE,RO]{\thepage}
\fancyhead[RE]{\nouppercase \leftmark}
\fancyhead[LO]{\nouppercase \rightmark}

%% -- One worked way to remove page number on the first page of chapter
%\makeatletter
%\let\ps@plain\ps@empty
%\makeatother
\fancypagestyle{plain}{ %
	\fancyhf{} % remove everything
	\renewcommand{\headrulewidth}{0pt} % remove lines as well
	\renewcommand{\footrulewidth}{0pt}
	\cfoot{\thepage} % Add page number at the center of page foot
}


%\usepackage{parskip}            % parskip separates non-indented paras by a blank line.
%\addtolength{\parskip}{0.2\parskip}

\usepackage{url}
%https://tex.stackexchange.com/questions/3033/forcing-linebreaks-in-url
\usepackage{xurl}
%\usepackage{doublespace}

% --------------------- For reference ---------------------%
%\usepackage[square,sort]{natbib}
\usepackage[round]{natbib}
%\usepackage[numbers]{natbib}
% https://tex.stackexchange.com/questions/93859/condense-the-space-between-bibliographic-entries
\setlength{\bibsep}{0pt plus 0.3ex}
 
 % Try using biblatex, but failed... how to clean the aux file on overleaf
 % https://tex.stackexchange.com/questions/479736/overleaf-does-not-compile-after-using-biblatex
 % https://tex.stackexchange.com/questions/88195/is-there-an-biblatex-equivalent-to-natbibs-citealp-command
 % biblatex using .bbx rather than .bst for style file...
 %https://tex.stackexchange.com/questions/174676/how-to-use-custom-bibstyle-with-biblatex
 %\usepackage[style=authoryear,url=false,isbn=false,backref=true,sorting=ynt,natbib]{biblatex}
 % --------------------- For reference ---------------------%

\usepackage{float}
\usepackage[labelfont=bf, labelsep=space]{caption} %labelsep=colon
\setcapindent{0pt} % To stop the second and subsequent lines of captions being indented. (Caused by exeterthesis)
% Set caption line spacing
% https://tex.stackexchange.com/questions/153334/change-the-baselinestretch-line-spacing-only-for-figure-captions
\captionsetup{font={small,stretch=1.2}}

\usepackage{subfig}
\usepackage{mathtools}   % For \shortintertext

\usepackage{tikz}
\usetikzlibrary{arrows}
\usetikzlibrary{positioning}
\usetikzlibrary{fit}
\usetikzlibrary{decorations.pathreplacing}   % for curly brackets
\usetikzlibrary{shadows}

% Glossary
\usepackage{nomencl}
\makenomenclature
\renewcommand{\nomname}{Glossary}
\RequirePackage{ifthen}
\renewcommand{\nomgroup}[1]{%
   \ifthenelse{\not\equal{#1}{A}}{\vspace{5mm}}{}%
   \ifthenelse{\equal{#1}{A}}{\item[\textbf{Acronyms and abbreviations}]}{%
   \ifthenelse{\equal{#1}{B}}{\item[\textbf{Matrix/vector/scalar notation}]}{%
   \ifthenelse{\equal{#1}{C}}{\item[\textbf{Probability density functions}]}{%
   \ifthenelse{\equal{#1}{R}}{\item[\textbf{Roman}]}{%
   \ifthenelse{\equal{#1}{G}}{\item[\textbf{Greek}]}{}}}}}}

% Appendix
\usepackage{appendix}

%\usepackage{fixltx2e}

%-------------------------------------------------------------------------------
% The following causes contents, citations, bookmarks etc to come out in colour.
% \usepackage{xcolor}
% \definecolor{myurlcolor}{rgb}{0, 0.427, 0.592}
\usepackage[bookmarks=false]{hyperref}
\hypersetup{linktoc=all,
            unicode=true,
            colorlinks=true,
            pdfstartview=Fit,
            pdfnewwindow=true}
\hypersetup{urlcolor= [rgb]{0,0.427,0.592},
            linkcolor=[rgb]{0,0.427,0.592},
            citecolor=[rgb]{0,0.427,0.592}}
%-------------------------------------------------------------------------------

\usepackage{scrhack}
\usepackage{lscape}

%\usepackage{framed}
\usepackage{afterpage}   % For \afterpage{\clearpage} to flush figures.
%\usepackage{fancybox}
%\setlength{\mylength}{\textwidth}%
%\newenvironment{FramedTable}%
%{\begin{table}[h]
%\begin{Sbox}%
%\setlength{\mylength}{\textwidth}%
%\addtolength{\mylength}{-2\fboxsep}%
%\addtolength{\mylength}{-2\fboxrule}%
%\begin{minipage}{\mylength}}%
%{\end{minipage}\end{Sbox}\fbox{\TheSbox}\end{table}}%


%\renewcommand{\topfraction}{0.9}	% max fraction of floats at top
%\renewcommand{\bottomfraction}{0.8}	% max fraction of floats at bottom
%   Parameters for TEXT pages (not float pages):
%    \setcounter{topnumber}{2}
%    \setcounter{bottomnumber}{2}
%    \setcounter{totalnumber}{4}     % 2 may work better
%    \setcounter{dbltopnumber}{2}    % for 2-column pages
%    \renewcommand{\dbltopfraction}{0.9}	% fit big float above 2-col. text
%    \renewcommand{\textfraction}{0.07}	% allow minimal text w. figs
%   Parameters for FLOAT pages (not text pages):
%\renewcommand{\floatpagefraction}{0.7}	% require fuller float pages
% N.B.: floatpagefraction MUST be less than topfraction !!
%\renewcommand{\dblfloatpagefraction}{0.7}	% require fuller float pages

% For thousands separators
\usepackage{siunitx}
%\usepackage[]{siunitx}

\usepackage{pifont}   % Also need to install the symbol package
\newcommand{\tick}{\ding{52}}

\usepackage{morefloats} % Latex Error: Float(s) lost.

%%%%%%%% ADDED BY MYSELF %%%%%%%%%%%
\usepackage{epigraph} % Added by Qun Liu, 2018/04/20, quoting
%\usepackage{fncychap}[Glenn]
%\usepackage[Glenn]{fncychap}
\usepackage{fncychap}  % Fancy chapter title styles
\usepackage{lipsum}  % Produce large text
\usepackage{bm} % math bold

\usepackage{booktabs} % for table, such as \midrule
\usepackage{multirow}
\usepackage{adjustbox}
\usepackage{diagbox}
\usepackage{mathrsfs}

% https://tex.stackexchange.com/questions/329206/multicolumn-with-line-break-does-not-center-properly
\usepackage{array}
\usepackage{makecell}

%-------------------------------------------------------------------------------
% Qun Liu, self-defined commands, 24/Nov/2020
\newcommand{\secref}[1]{Section \ref{#1}}
\newcommand{\figref}[1]{Figure \ref{#1}}
\newcommand{\figsref}[1]{Figures \ref{#1}}
\newcommand{\tabref}[1]{Table \ref{#1}}
\newcommand{\Eqref}[1]{Equation (\ref{#1})}
\let\eqref\Eqref        % replace the original \eqref with \Eqref
\newcommand{\chapref}[1]{Chapter \ref{#1}}
%-------------------------------------------------------------------------------

\usepackage{rotating}
\usepackage{enumitem}
\usepackage{threeparttable}
% change the font size of threeparttable's table notes
% https://tex.stackexchange.com/questions/108584/how-best-to-change-the-font-size-etc-of-threeparttables-table-notes
\appto\TPTnoteSettings{\footnotesize}

% https://www.overleaf.com/learn/latex/indices
\usepackage{imakeidx}
\makeindex[columns=2, title=Index, intoc]

% enable links for doi
% https://tex.stackexchange.com/questions/50023/produce-a-hyperlinked-doi
\usepackage{doi}

% https://tex.stackexchange.com/questions/1656/footnote-counter-would-like-to-restart-from-1-each-page
\usepackage[perpage]{footmisc}