\chapter{Changes of Cloud Radiative Effect to Global Warming}
\label{ch:cld_fbk}

In \chapref{ch:simple_cld_scheme}, we have introduced how the simple cloud scheme is constructed, and have evaluated the simulated climatology when it is implemented in Isca. The simulations have shown that it can grasp the basic features of cloud climatology. In this chapter, the simulated cloud feedbacks under global warming are to be examined. Also, based on this simple cloud scheme, a series of perturbed parameter ensemble (PPE) experiments are carried out to investigate whether they can `reproduce' the inter-model spread of cloud feedbacks among CMIP models. Based on the results, the sensitivities of the corresponding parameters, components and processes are analyzed. The cloud controlling factor analysis are employed to identify the possible causes for the cloud responses.

The major findings are

\begin{enumerate}
    \item The simulated cloud feedback from the simple cloud scheme is generally reasonable, but failed to grasp the strong negative optical depth feedback in Southern Ocean regions, as the ice condensate is not explicitly represented in the simple cloud scheme.
    \item The low cloud amount feedback is the single largest contributor to the net cloud feedback spread of the PPE, which is consistent with the inter-model spread of CMIP models.
    % consistent with previous studies such as \cite{Bony2005, Zelinka2016insights}.
    \item The regions abundant of stratocumulus clouds show negative feedback in the simulations, as the low cloud component of the simple cloud scheme depends too strongly on the inversion strength.
    \item For ECS, ...
\end{enumerate}

\section{Introduction}



%The next question is that whether we will evaluate

%the cloud radiative effect responses to climate change is to be investigated in this chapter.
In this chapter, the following questions are going to be answered. First, could the simple scheme grasp the key mechanisms for cloud feedback? The results in \chapref{ch:simple_cld_scheme} have shown that the simple cloud scheme could grasp a relatively reasonable cloud, but as pointed by \cite{Zelinka2021evaluating} that better simulation of mean-state cloud properties does not necessarily guarantee better cloud feedbacks.

Could we ‘reproduce’ the spread of cloud feedback by perturbing a series of physical parameters? And which parameter or process is most sensitive?

What are the implications for equilibrium climate sensitivity?


% The spread of cloud feedback

The chapter is to be organized as follows: in the se


\section{Simulation setup}
%Similar to the setups in \secref{sec:eval_cld_exp_setup}, here the SST has a uniform 4K warming.

\subsection{Implementation of the COSP}
As introduced in \secref{sec:Zelinka_method}, one possible way to calculate the cloud feedback is to use the cloud radiative kernel \citep{Zelinka2012computing1,Zelinka2012computing2}, in which the joint-histogram between cloud top pressure and optical depth from ISCCP cloud simulator is needed. One can simply estimate the cloud feedback by the change of cloud radiative effect between control and perturbed experiments, but it also includes the masking effect of climatological cloudiness on non-cloud feedbacks \citep{Soden2004}. In addition, combining the histogram outputs from ISCCP cloud simulator with cloud radiative kernel, one can decompose the cloud feedback into  different altitude and different components \citep{Zelinka2012computing2,Zelinka2016insights}, which is a helpful tool for us to understand the causes of spread in multi-model spread of cloud feedback. As mentioned in \secref{ch:simple_cld_scheme}, the cloud simulator has not been implemented in Isca, and we could not employ the cloud radiative kernel method to calculate and decompose cloud feedback without it. Thus in this section, we try to implement the cloud simulator in Isca first in order for a refined look into cloud feedback.

% In this study, the Cloud Feedback Model Intercomparison Project (CFMIP) Observational Simulator Package (COSP) version 2 \citep{Swales2018}, which can be accessed at \url{https://github.com/CFMIP/COSPv2.0}, is implemented in Isca. COSP was originally developed as a satellite simulator package whose aim is to produce virtual satellite observations from atmospheric model fields for a better comparison of model output with observations \citep{Bodas2011}. This approach is needed because the satellite retrievals generally do not directly correspond to the numerical model fields due to the mismatch between their definitions of certain fields. COSP accounts for the limited view of the satellite instrument by calculating radiative transfer through the atmosphere, i.e. attenuation by hydrometeors and air molecules and backscattering \citep{Kuma2020}. Note that multiple instrument simulators, such as MODIS, CALIPSO, CloudSat and ISCCP, have been incorporated in COSP, and it is flexible for users to decide which one to use based on their research purposes. 

% Specifically, several modules have been written in Isca to call COSP, in which the outputs from simple cloud scheme and SOCRATES radiation schemes, such as cloud fraction, effective radius, cloud water content and cloud optical depth, are provided through the interfaces. However, as the cloud scheme is simple and there is not microphysics scheme in Isca, we could not provide some properties about convective clouds and cloud condensate such as ice and graupel. Although this may bring some problems, the outputs from ISCCP simulator are relatively reasonable.

\subsection{Q-flux}
% The simulations in \chapref{ch:simple_cld_scheme} are the AMIP-type fixed-SST experiments, and the changes in atmosphere could not feedback into the SST changes. To make it more realistic, here we prescribe the derived ocean heat transport flux (the `Q-flux') from a given distribution of SSTs following the method from \cite{Russell1985}, so that the SST can respond freely to the CO$_2$ forcing. As in \chapref{ch:simple_cld_scheme}, the observed SST is from the input4MIPs data set \citep{Durack2018} over the period from 1979 to 2008. To derive the Q-flux, the aforementioned SST climatology is prescribed in a simulation with the realistic continents and a slab ocean of 20m depth. The energy balance model is applied as follows:
% \begin{equation}
%     F_Q = C_w\rho_w D \frac{\partial T}{\partial t} - F_s,
%     \label{eq:Q_flux}
% \end{equation}

% \begin{equation}
%     F_s = SW-LH-SH-LW,
%     \label{eq:surface_flux}
% \end{equation}
% where $F_Q$ is the Q-flux to be derived, which distributes energy globally to match the prescribed SST distribution. The $C_w$ (3989.24 J kg$^{-1}$ K$^{-1}$) and $\rho_w$ (1035 kg m$^{-3}$) are the specific heat capacity and density of ocean water, respectively. $D$ is the depth of mixed layer. The rate of change in mixed layer temperature ($\frac{\partial T}{\partial t}$, in units of K s$^{-1}$) is calculated by the prescribed SST. The surface flux ($F_s$, positive downward, units Wm$^{-2}$) in \Eqref{eq:Q_flux} is calculated from the upward latent and sensible heat fluxes ($LH$ and $SH$, respectively), the net longwave radiation ($LW$, positive upward) and net shortwave radiation ($SW$, positive downward), as indicated by \Eqref{eq:surface_flux}.

% \begin{figure}[ht]
% 	\centering
% 	\includegraphics[width=1\linewidth]{{figs/change_of_CRE/Q-flux_cmp}.png}
% 	\caption[Comparison of spatial pattern of ocean heat transport (Q-flux).]{Annual mean Q-flux pattern (in W m$^{-2}$) derived from AMIP fixed-SST experiments with realistic continents and topography. The cloud schemes used are (a) linear, (b) linear\_FD and (c) linear\_ALL as in \tabref{tab:exps} and (d) no cloud scheme.}
% 	\label{fig:Q_flux_cmp}
% \end{figure}

% The AMIP fixed-SST experiments with linear cloud scheme described in \tabref{tab:exps} and a new fixed-SST simulation without clouds are used to derived the Q-flux, and the results are shown in \figref{fig:Q_flux_cmp}. The spatial patterns of Q-flux from different cloud schemes are similar, and have some differences from the simulation without cloud in subtropical and Southern Ocean regions. Q-flux can capture the ocean currents such as the Gulf Stream and cold tongue in the eastern tropical Pacific (\figref{fig:Q_flux_cmp}), and the positive value compensates for too little heating to the slab ocean by the surface flux from the `prescribed-SST’ run compared to the SST climatology. In this case, the Q-flux obtained from the run with the linear cloud scheme only is used in the following simulations. Also, the Q-flux remains the same in the control and perturbed experiments, but it is noted that the SST can change freely in response to different CO$_2$ forcing. 

\subsection{Perturbed parameter ensemble}
 
 \begin{table}
%\begin{sidewaystable}
	\caption{Design of the perturbed parameter experiments (PPEs). All simulations are run in T42 horizontal resolution.}
	\centering
	\renewcommand{\arraystretch}{1.5}
	\resizebox{\textwidth}{!}{
	\begin{tabular}{c >{\raggedright}m{0.26\linewidth} m{0.6\linewidth}} 
	% control width, alignment for cells
	% https://texblog.org/2017/02/06/proper-tables-with-latex/
		\toprule
	    Experiment & Parameter / Switch & Description \\
		\midrule
		Linear & Default values in \tabref{tab:cld_scheme_summary} & Simulations with Q-flux; Control (1$\times$CO$_2$) and perturbed (4$\times$CO$_2$) experiments \\
		a\_surf & $a_{s}: 42 \rightarrow 20$ & Equivalent to decrease the critical relative humidity at the surface \\
		a\_top & $a_{t}: 13 \rightarrow 10$ & Equivalent to decrease the critical relative humidity at the upper troposphere \\
		Sc\_coeff & $c: -0.1 \rightarrow -0.3$ & The added stratocumulus clouds should decrease \\
		Tmax &  $T_{max}:-5\rightarrow 0~^\circ$C & Increase the temperature threshold of the fraction of liquid cloud (Reff would increase)\\
		Tmin & $T_{min}: -40\rightarrow -20~^\circ$C & Increase the temperature threshold of the fraction of ice cloud\\
		Reff\_ice & $r_{e_ice}:25\rightarrow 50~\mu$m & Increase th default effective radius for ice cloud (Reff would increase)\\
		%rcl\_height &  & In-cloud liquid water mixing ratio is specified as a function of height, rather than as temperature\\
		freezedry & On & Use the freezedry method \\
		Sundqvist & Default values & Change the default cloud fraction scheme from linear to Sundqvist\\
		\bottomrule
	\end{tabular}
	}
	\label{tab:qflux_ppe_exps_summary}
%\end{sidewaystable}
\end{table}

\section{Results}



\section{Summary and discussion}